<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Martin's Card Formatter</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Source+Code+Pro:wght@400;500&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="page">
    <header class="hero">
      <div>
        <p class="eyebrow">Print-Ready Cards</p>
        <h1>Martin's Card Formatter</h1>
        <p class="lede">
          Upload your card images, pick a layout, and export a duplex-ready PDF with corner
          crosshair guides. Designed for poker-size cards, with flexible spacing and page sizes.
        </p>
      </div>
      <div class="hero-card">
        <div>
          <p class="stat">Poker size</p>
          <p class="stat-value">2.5" × 3.5"</p>
        </div>
        <div>
          <p class="stat">Bleed gap</p>
          <p class="stat-value">0.25" between cards</p>
        </div>
        <div>
          <p class="stat">Duplex</p>
          <p class="stat-value">Flip edge varies by layout</p>
        </div>
      </div>
    </header>

    <main class="panel">
      <section class="panel-section">
        <h2>1. Upload Files</h2>
        <div class="input-grid">
          <label class="upload-box">
            <input id="frontFiles" type="file" accept="image/png,image/jpeg" multiple />
            <span class="upload-title">Front images</span>
            <span class="upload-sub">PNG or JPG, multiple files.</span>
          </label>
          <label class="upload-box">
            <input id="backFile" type="file" accept="image/png,image/jpeg" />
            <span class="upload-title">Back image (optional)</span>
            <span class="upload-sub">Single image for all backs.</span>
          </label>
          <label class="upload-box">
            <input id="backFilesPerPage" type="file" accept="image/png,image/jpeg" multiple />
            <span class="upload-title">Back images per page</span>
            <span class="upload-sub">One back image per output page.</span>
          </label>
        </div>
        <div class="choice-row">
          <span class="choice-label">Backs mode</span>
          <label class="choice-pill">
            <input type="radio" name="backMode" value="single" checked />
            Single back
          </label>
          <label class="choice-pill">
            <input type="radio" name="backMode" value="perPage" />
            Per-page backs
          </label>
        </div>
        <div class="toggle-row">
          <label class="switch">
            <input id="duplexToggle" type="checkbox" checked />
            <span class="slider"></span>
          </label>
          <span>Include duplex backs</span>
          <span class="duplex-note" id="duplexNote">Flip on long edge for 3 × 3. Flip on short edge for 2 × 3.</span>
          <span class="info-badge" title="Flip edge depends on layout. Backs are mirrored to align after printing and flipping.">i</span>
        </div>
      </section>

      <section class="panel-section">
        <h2>2. Layout Settings</h2>
        <div class="input-row">
          <label>
            Card size
            <select id="cardSizeSelect">
              <option value="poker">Poker (2.5" × 3.5")</option>
              <option value="square">Square (2.5" × 2.5")</option>
              <option value="bridge">Bridge (2.25" × 3.5")</option>
              <option value="mini">Mini (1.75" × 2.5")</option>
            </select>
          </label>
          <label>
            Output format
            <select id="layoutSelect">
              <option value="grid3x3">3 × 3 grid</option>
              <option value="gutterfold">Gutterfold (2 columns)</option>
              <option value="grid2x3bleed">2 × 3 Buttonshy Games Style (0.25" edge bleed)</option>
            </select>
          </label>
          <label>
            Page size
            <select id="pageSizeSelect">
              <option value="letter">US Letter</option>
              <option value="a4">A4</option>
            </select>
          </label>
          <label class="fit-label">
            <span class="fit-header">
              Image fit
              <span class="tooltip" tabindex="0" data-tooltip="Cover fills the card and may crop edges. Contain fits the entire image inside the card and may leave borders.">i</span>
            </span>
            <select id="fitSelect">
              <option value="cover">Cover (crop to fill)</option>
              <option value="contain">Contain (fit inside)</option>
            </select>
          </label>
        </div>

        <div class="input-row">
          <label>
            Gutterfold center gutter (in)
            <input id="gutterInput" type="number" min="0" step="0.05" value="0.25" />
          </label>
          <label>
            Crosshair length (px)
            <input id="crosshairLength" type="number" min="10" step="1" value="25" />
          </label>
          <label>
            Crosshair stroke (pt)
            <input id="crosshairStroke" type="number" min="1" step="0.5" value="2" />
          </label>
        </div>
        <div class="action-row">
          <button id="autoLayoutBtn" type="button">Auto-layout</button>
          <div class="helper">Chooses the best fitting layout and page size.</div>
        </div>
        <p class="helper">
          Note: The 2 × 3 Buttonshy Games Style is interpreted as 3 columns × 2 rows, uses a landscape page, and extends
          image edges by 0.25\" per side. Cut guides remain at the original card size. 3 × 3 uses a portrait page and flips on
          the long edge when duplex.
        </p>
      </section>

      <section class="panel-section">
        <h2>3. Preview</h2>
        <div class="toggle-row">
          <label class="switch">
            <input id="previewBackToggle" type="checkbox" />
            <span class="slider"></span>
          </label>
          <span>Preview backs</span>
        </div>
        <div class="preview-shell">
          <canvas id="previewCanvas" width="900" height="650"></canvas>
          <div class="preview-meta" id="previewMeta">Preview updates automatically.</div>
        </div>
      </section>

      <section class="panel-section">
        <h2>4. Thumbnails</h2>
        <div class="thumb-grid" id="frontThumbs"></div>
        <div class="thumb-grid" id="backThumbs"></div>
        <div class="helper" id="thumbMeta">Upload images to see thumbnails.</div>
      </section>

      <section class="panel-section">
        <h2>5. Export</h2>
        <div class="action-row">
          <button id="generateBtn">Generate PDF</button>
          <div class="status" id="status">Waiting for files…</div>
        </div>
      </section>
    </main>

    <footer class="footer">
      <p>Tip: Use consistently sized front images for best alignment.</p>
    </footer>
  </div>

  <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
  <script src="app.js"></script>
</body>
</html>
