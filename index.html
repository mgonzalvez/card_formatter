<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Martin's Card Formatter</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Source+Code+Pro:wght@400;500&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="page">
    <header class="hero">
      <div>
        <p class="eyebrow">Print-Ready Cards</p>
        <h1>Martin's Card Formatter</h1>
        <p class="lede">
          Upload your card images, pick a layout, and export a duplex-ready PDF with corner
          crosshair guides, with flexible spacing and page sizes.
        </p>
      </div>
        <div class="hero-card">
          <div>
            <p class="stat" id="summaryLabel1">Layout</p>
            <p class="stat-value" id="summaryValue1">Traditional card grid</p>
          </div>
          <div>
            <p class="stat" id="summaryLabel2">Card size</p>
            <p class="stat-value" id="summaryValue2">2.5" × 3.5"</p>
          </div>
          <div>
            <p class="stat" id="summaryLabel3">Details</p>
            <p class="stat-value" id="summaryValue3">Bleed: none · Backs: none</p>
          </div>
        </div>
    </header>

    <main class="panel">
      <section class="panel-section">
        <h2>1. Upload Files</h2>
        <div class="input-grid">
          <label class="upload-box">
            <input id="frontFiles" type="file" accept="image/png,image/jpeg" multiple />
            <span class="upload-title">Front images</span>
            <span class="upload-sub">PNG or JPG, multiple files.</span>
          </label>
          <label class="upload-box">
            <input id="backFiles" type="file" accept="image/png,image/jpeg" multiple />
            <span class="upload-title">Back image(s)</span>
            <span class="upload-sub">Upload 1 for all cards, or multiple to assign per card.</span>
          </label>
        </div>
        <div class="toggle-row">
          <span class="duplex-note" id="duplexNote">Upload a back image to enable duplex output.</span>
          <span class="info-badge" title="Flip edge depends on layout. Backs are mirrored to align after printing and flipping.">i</span>
        </div>
        <p class="helper">Landscape images are auto-rotated so the card's right edge points upward.</p>
      </section>

      <section class="panel-section">
        <h2>2. Layout Settings</h2>
        <div class="toggle-row">
          <label class="switch">
            <input id="unitToggle" type="checkbox" />
            <span class="slider"></span>
          </label>
          <span id="unitLabel">Units: Imperial (inches)</span>
        </div>
        <div class="input-row">
          <label>
            Card size
            <select id="cardSizeSelect">
              <option value="poker">Poker (2.5" × 3.5")</option>
              <option value="square">Square (2.5" × 2.5")</option>
              <option value="bridge">Bridge (2.25" × 3.5")</option>
              <option value="mini">Mini (1.75" × 2.5")</option>
            </select>
          </label>
          <label>
            Output format
            <select id="layoutSelect">
              <option value="grid3x3">Traditional card grid</option>
              <option value="gutterfold">Gutterfold (2 columns)</option>
              <option value="grid2x3bleed">Buttonshy Games Style (with bleed)</option>
            </select>
          </label>
          <label>
            Page size
            <select id="pageSizeSelect">
              <option value="letter">US Letter</option>
              <option value="a4">A4</option>
            </select>
          </label>
          <label class="fit-label">
            <span class="fit-header">
              Image fit
              <span class="tooltip" tabindex="0" data-tooltip="Cover fills the card and may crop edges. Contain fits the entire image inside the card and may leave borders.">i</span>
            </span>
            <select id="fitSelect">
              <option value="cover">Cover (crop to fill)</option>
              <option value="contain">Contain (fit inside)</option>
            </select>
          </label>
        </div>

        <div class="input-row">
          <label>
            <span id="gutterLabel">Gutterfold center gutter (in)</span>
            <input id="gutterInput" type="number" min="0.25" max="0.75" step="0.05" value="0.25" />
          </label>
          <label>
            Crosshair length (px)
            <input id="crosshairLength" type="number" min="10" max="30" step="1" value="20" />
          </label>
          <label>
            Crosshair stroke (pt)
            <input id="crosshairStroke" type="number" min="1" max="3" step="0.5" value="1" />
          </label>
        </div>
        <div class="action-row">
          <button id="autoLayoutBtn" type="button">Auto-layout</button>
          <div class="helper">Chooses the best fitting layout and page size.</div>
        </div>
        <p class="helper" id="layoutHelper">
          Note: Buttonshy Games Style uses a landscape page and extends image edges by 0.25\" per side. Cut guides remain at
          the original card size. Traditional card grid uses a portrait page and flips on the long edge when duplex.
        </p>
      </section>

      <section class="panel-section">
        <h2>3. Preview</h2>
        <div class="toggle-row">
          <label class="switch">
            <input id="previewBackToggle" type="checkbox" />
            <span class="slider"></span>
          </label>
          <span>Preview backs</span>
        </div>
        <div class="preview-shell">
          <canvas id="previewCanvas" width="900" height="650"></canvas>
          <div class="preview-meta" id="previewMeta">Preview updates automatically.</div>
        </div>
      </section>

      <section class="panel-section">
        <h2>4. Thumbnails</h2>
        <div class="thumb-toolbar">
          <label class="thumb-checkbox">
            <input type="checkbox" id="selectAllFronts" />
            Select all
          </label>
          <span class="thumb-title">Assign selected fronts to back:</span>
          <select id="batchBackSelect"></select>
          <button id="applyBackBtn" type="button">Apply</button>
        </div>
        <div class="helper" id="backAssignHelper">Upload multiple card backs to enable card back assignments.</div>
        <div class="thumb-grid" id="frontThumbs"></div>
        <div class="thumb-grid" id="backThumbs"></div>
        <div class="helper" id="thumbMeta">Upload images to see thumbnails.</div>
      </section>

      <section class="panel-section">
        <h2 id="exportHeading">5. Export</h2>
        <div class="action-row">
          <button id="generateBtn">Generate PDF</button>
          <div class="status" id="status">Waiting for files…</div>
        </div>
      </section>
    </main>

    <footer class="footer">
      <p>Tip: Use consistently sized front images for best alignment.</p>
    </footer>
  </div>

  <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
  <script src="app.js"></script>
</body>
</html>
